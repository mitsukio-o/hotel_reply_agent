# ãƒ›ãƒ†ãƒ«å‘ã‘è‡ªå‹•è¿”ä¿¡ã‚·ã‚¹ãƒ†ãƒ  - ä½¿ç”¨ä¾‹

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€ãƒ›ãƒ†ãƒ«å‘ã‘è‡ªå‹•è¿”ä¿¡ã‚·ã‚¹ãƒ†ãƒ ã®å…·ä½“çš„ãªä½¿ç”¨æ–¹æ³•ã¨å®Ÿéš›ã®ã‚·ãƒŠãƒªã‚ªã‚’è©³ã—ãèª¬æ˜ã—ã¾ã™ã€‚

## ğŸ“‹ ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦](#ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦)
2. [ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †](#ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †)
3. [åŸºæœ¬çš„ãªä½¿ç”¨ä¾‹](#åŸºæœ¬çš„ãªä½¿ç”¨ä¾‹)
4. [å®Ÿéš›ã®ã‚·ãƒŠãƒªã‚ªä¾‹](#å®Ÿéš›ã®ã‚·ãƒŠãƒªã‚ªä¾‹)
5. [APIä½¿ç”¨ä¾‹](#apiä½¿ç”¨ä¾‹)
6. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

## ğŸ¨ ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯ã€Booking.comã‚„Airbnbãªã©ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ã®ã‚²ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¯¾ã—ã¦ã€AIã‚’æ´»ç”¨ã—ãŸè‡ªå‹•è¿”ä¿¡å€™è£œã‚’ç”Ÿæˆã—ã€ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§è¿”ä¿¡ã§ãã‚‹ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

### ä¸»è¦æ©Ÿèƒ½
- **ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ **: ãƒ›ãƒ†ãƒ«å‘¨è¾ºæƒ…å ±æ¤œç´¢ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨äºˆç´„ãƒ‡ãƒ¼ã‚¿å­¦ç¿’ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
- **è‡ªå‹•è¿”ä¿¡å€™è£œç”Ÿæˆ**: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹ã«åŸºã¥ã„ã¦3ã¤ã®è¿”ä¿¡å€™è£œã‚’è‡ªå‹•ç”Ÿæˆ
- **ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯è¿”ä¿¡**: é¸æŠã—ãŸå€™è£œã§å³åº§ã«ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«è¿”ä¿¡
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å–å¾—**: Booking.com/Airbnb APIã‹ã‚‰æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªå‹•å–å¾—
- **å­¦ç¿’æ©Ÿèƒ½**: éå»ã®å¯¾å¿œãƒ­ã‚°ã‹ã‚‰å­¦ç¿’ã—ã€è¿”ä¿¡å“è³ªã‚’å‘ä¸Š

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### 1. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€å¿…è¦ãªAPIã‚­ãƒ¼ã‚’è¨­å®šã—ã¦ãã ã•ã„ï¼š

```bash
# OpenAI APIã‚­ãƒ¼ï¼ˆå¿…é ˆï¼‰
OPENAI_API_KEY=sk-your-openai-api-key-here

# Google Maps APIã‚­ãƒ¼ï¼ˆå¿…é ˆï¼‰
GOOGLE_MAPS_API_KEY=your-google-maps-api-key-here

# Booking.com APIã‚­ãƒ¼ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
BOOKING_API_KEY=your-booking-api-key-here

# Airbnb APIã‚­ãƒ¼ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
AIRBNB_API_KEY=your-airbnb-api-key-here

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®š
DATABASE_URL=postgresql://postgres:password@localhost:5432/hotel_agent_db

# Redisè¨­å®š
REDIS_URL=redis://localhost:6379/0

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
APP_NAME=Hotel Response Agent
DEBUG=True
HOST=0.0.0.0
PORT=8000
```

### 2. Docker Composeã‚’ä½¿ç”¨ã—ãŸèµ·å‹•

```bash
# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•
docker-compose up -d

# ãƒ­ã‚°ã‚’ç¢ºèª
docker-compose logs -f

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åœæ­¢
docker-compose down
```

### 3. æ‰‹å‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’åˆæœŸåŒ–
python -c "from app.database import create_tables; create_tables()"

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’æŠ•å…¥
python app/seed_data.py

# FastAPIã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•
python -m uvicorn app.main:app --reload

# åˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§Streamlitã‚’èµ·å‹•
streamlit run streamlit_app.py
```

## ğŸ“± åŸºæœ¬çš„ãªä½¿ç”¨ä¾‹

### 1. Webã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹

- **Streamlit UI**: http://localhost:8501
- **FastAPI Docs**: http://localhost:8000/docs

### 2. ãƒ›ãƒ†ãƒ«ç™»éŒ²

Streamlit UIã§ã€Œãƒ›ãƒ†ãƒ«é¸æŠã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦æ–°ã—ã„ãƒ›ãƒ†ãƒ«ã‚’ç™»éŒ²ï¼š

```python
# APIçµŒç”±ã§ãƒ›ãƒ†ãƒ«ã‚’ç™»éŒ²
import requests

hotel_data = {
    "name": "ã‚µãƒ³ãƒ—ãƒ«ãƒ›ãƒ†ãƒ«",
    "address": "æ±äº¬éƒ½æ¸‹è°·åŒºé“ç„å‚1-2-3",
    "latitude": 35.6581,
    "longitude": 139.7016,
    "city": "æ±äº¬",
    "country": "æ—¥æœ¬"
}

response = requests.post("http://localhost:8000/hotels", params=hotel_data)
print(response.json())
```

### 3. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç®¡ç†

1. ã€Œãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç®¡ç†ã€ã‚¿ãƒ–ã§æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—
2. æœªå‡¦ç†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã€Œè¿”ä¿¡å€™è£œã‚’å–å¾—ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ç”Ÿæˆã•ã‚ŒãŸ3ã¤ã®å€™è£œã‹ã‚‰é¸æŠ
4. ã€Œã“ã®å€™è£œã§è¿”ä¿¡ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦é€ä¿¡

## ğŸ¯ å®Ÿéš›ã®ã‚·ãƒŠãƒªã‚ªä¾‹

### ã‚·ãƒŠãƒªã‚ª1: è·ç‰©é ã‹ã‚Šã®å•ã„åˆã‚ã›

**ã‚²ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:**
```
ã€Œãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³å‰ã«è·ç‰©ã‚’é ã‹ã£ã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿåˆå‰10æ™‚ã«åˆ°ç€äºˆå®šã§ã™ã€‚ã€
```

**ã‚·ã‚¹ãƒ†ãƒ ã®å‡¦ç†:**
1. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—ã‚’ã€Œè·ç‰©é ã‹ã‚Šã€ã¨ã—ã¦åˆ†é¡
2. ãƒ›ãƒ†ãƒ«å‘¨è¾ºæƒ…å ±ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒè·ç‰©é ã‹ã‚Šã‚µãƒ¼ãƒ“ã‚¹ã‚’æ¤œç´¢
3. äºˆç´„ãƒ‡ãƒ¼ã‚¿å­¦ç¿’ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒéå»ã®é¡ä¼¼å¯¾å¿œã‚’åˆ†æ
4. 3ã¤ã®è¿”ä¿¡å€™è£œã‚’ç”Ÿæˆ

**ç”Ÿæˆã•ã‚Œã‚‹è¿”ä¿¡å€™è£œ:**

**å€™è£œ1ï¼ˆé«˜ä¿¡é ¼åº¦ï¼‰:**
```
ãŠå®¢æ§˜ã€ãŠç–²ã‚Œæ§˜ã§ã™ã€‚

ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³å‰ã®è·ç‰©é ã‹ã‚Šã‚µãƒ¼ãƒ“ã‚¹ã‚’ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚
åˆå‰10æ™‚ã«ãŠè¶Šã—ã„ãŸã ãã€ãƒ•ãƒ­ãƒ³ãƒˆãƒ‡ã‚¹ã‚¯ã¾ã§ãŠå£°ãŒã‘ãã ã•ã„ã€‚
è·ç‰©ã¯å®‰å…¨ã«ä¿ç®¡ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚

ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æ™‚é–“ã¯15:00ã‹ã‚‰ã¨ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
ã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå£°ãŒã‘ãã ã•ã„ã€‚

ãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™ã€‚
```

**å€™è£œ2ï¼ˆä¸­ä¿¡é ¼åº¦ï¼‰:**
```
ã“ã‚“ã«ã¡ã¯ã€‚

è·ç‰©é ã‹ã‚Šã‚µãƒ¼ãƒ“ã‚¹ã¯æ‰¿ã£ã¦ãŠã‚Šã¾ã™ã€‚
åˆå‰10æ™‚ã«ãŠè¶Šã—ã„ãŸã ãã€ãƒ•ãƒ­ãƒ³ãƒˆãƒ‡ã‚¹ã‚¯ã§ãŠé ã‹ã‚Šã„ãŸã—ã¾ã™ã€‚
ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³æ™‚é–“ï¼ˆ15:00ï¼‰ã¾ã§å®‰å…¨ã«ä¿ç®¡ã„ãŸã—ã¾ã™ã€‚

ã”è³ªå•ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå£°ãŒã‘ãã ã•ã„ã€‚
```

**å€™è£œ3ï¼ˆä½ä¿¡é ¼åº¦ï¼‰:**
```
ãŠå®¢æ§˜

è·ç‰©é ã‹ã‚Šã¯å¯èƒ½ã§ã™ã€‚
ãƒ•ãƒ­ãƒ³ãƒˆãƒ‡ã‚¹ã‚¯ã¾ã§ãŠè¶Šã—ãã ã•ã„ã€‚
```

### ã‚·ãƒŠãƒªã‚ª2: äºˆç´„å¯èƒ½æœŸé–“ã®å•ã„åˆã‚ã›

**ã‚²ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:**
```
ã€Œæ¥æœˆã®15æ—¥ã‹ã‚‰3æ³Š4æ—¥ã§äºˆç´„ã§ãã¾ã™ã‹ï¼Ÿã€
```

**ã‚·ã‚¹ãƒ†ãƒ ã®å‡¦ç†:**
1. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—ã‚’ã€Œäºˆç´„ç¢ºèªã€ã¨ã—ã¦åˆ†é¡
2. äºˆç´„ãƒ‡ãƒ¼ã‚¿å­¦ç¿’ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒéå»ã®äºˆç´„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åˆ†æ
3. ãƒ›ãƒ†ãƒ«å‘¨è¾ºæƒ…å ±ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒè¦³å…‰åœ°æƒ…å ±ã‚’å–å¾—
4. 3ã¤ã®è¿”ä¿¡å€™è£œã‚’ç”Ÿæˆ

**ç”Ÿæˆã•ã‚Œã‚‹è¿”ä¿¡å€™è£œ:**

**å€™è£œ1ï¼ˆé«˜ä¿¡é ¼åº¦ï¼‰:**
```
ãŠå®¢æ§˜ã€ãŠç–²ã‚Œæ§˜ã§ã™ã€‚

æ¥æœˆ15æ—¥ã‹ã‚‰3æ³Š4æ—¥ã®ã”äºˆç´„ã«ã¤ã„ã¦ãŠèª¿ã¹ã„ãŸã—ã¾ã™ã€‚
ç¾åœ¨ã€ãã®æœŸé–“ã®ç©ºå®¤çŠ¶æ³ã‚’ç¢ºèªã„ãŸã—ã¾ã™ã€‚

ãŠè¿‘ãã«ã¯ä»¥ä¸‹ã®è¦³å…‰åœ°ãŒã”ã–ã„ã¾ã™ï¼š
- æµ…è‰å¯ºï¼ˆå¾’æ­©10åˆ†ï¼‰
- æ±äº¬ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼ï¼ˆé›»è»Šã§15åˆ†ï¼‰
- ä¸Šé‡å…¬åœ’ï¼ˆé›»è»Šã§20åˆ†ï¼‰

è©³ç´°ãªç©ºå®¤çŠ¶æ³ã¨æ–™é‡‘ã«ã¤ã„ã¦ã¯ã€æ”¹ã‚ã¦ã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚
ãŠæ€¥ãã®å ´åˆã¯ã€ãŠé›»è©±ã§ã‚‚ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚

ãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™ã€‚
```

### ã‚·ãƒŠãƒªã‚ª3: å‘¨è¾ºè¦³å…‰åœ°ã®å•ã„åˆã‚ã›

**ã‚²ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:**
```
ã€Œãƒ›ãƒ†ãƒ«å‘¨è¾ºã§ãŠã™ã™ã‚ã®è¦³å…‰åœ°ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿã€
```

**ã‚·ã‚¹ãƒ†ãƒ ã®å‡¦ç†:**
1. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—ã‚’ã€Œè¦³å…‰åœ°æƒ…å ±ã€ã¨ã—ã¦åˆ†é¡
2. ãƒ›ãƒ†ãƒ«å‘¨è¾ºæƒ…å ±ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒGoogle Maps APIã‚’ä½¿ç”¨ã—ã¦å‘¨è¾ºè¦³å…‰åœ°ã‚’æ¤œç´¢
3. éå»ã®å¯¾å¿œãƒ­ã‚°ã‹ã‚‰äººæ°—ã®è¦³å…‰åœ°ã‚’åˆ†æ
4. 3ã¤ã®è¿”ä¿¡å€™è£œã‚’ç”Ÿæˆ

**ç”Ÿæˆã•ã‚Œã‚‹è¿”ä¿¡å€™è£œ:**

**å€™è£œ1ï¼ˆé«˜ä¿¡é ¼åº¦ï¼‰:**
```
ãŠå®¢æ§˜ã€ãŠç–²ã‚Œæ§˜ã§ã™ã€‚

ãƒ›ãƒ†ãƒ«å‘¨è¾ºã®ãŠã™ã™ã‚è¦³å…‰åœ°ã‚’ã”æ¡ˆå†…ã„ãŸã—ã¾ã™ï¼š

ã€å¾’æ­©åœå†…ã€‘
ãƒ»æµ…è‰å¯ºï¼ˆå¾’æ­©10åˆ†ï¼‰- æ±äº¬ã®ä»£è¡¨çš„ãªè¦³å…‰åœ°
ãƒ»æµ…è‰èŠ±ã‚„ã—ãï¼ˆå¾’æ­©15åˆ†ï¼‰- æ—¥æœ¬æœ€å¤ã®éŠåœ’åœ°

ã€é›»è»Šã§15åˆ†ä»¥å†…ã€‘
ãƒ»æ±äº¬ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼ï¼ˆé›»è»Šã§10åˆ†ï¼‰- æ±äº¬ã®æ–°åæ‰€
ãƒ»ä¸Šé‡å…¬åœ’ï¼ˆé›»è»Šã§15åˆ†ï¼‰- åšç‰©é¤¨ãƒ»ç¾è¡“é¤¨ãŒå……å®Ÿ

ã€é›»è»Šã§30åˆ†ä»¥å†…ã€‘
ãƒ»çš‡å±…ï¼ˆé›»è»Šã§25åˆ†ï¼‰- æ±äº¬ã®ä¸­å¿ƒéƒ¨
ãƒ»éŠ€åº§ï¼ˆé›»è»Šã§20åˆ†ï¼‰- ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ã‚¨ãƒªã‚¢

å„è¦³å…‰åœ°ã®è©³ç´°æƒ…å ±ã‚„ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€ãƒ•ãƒ­ãƒ³ãƒˆãƒ‡ã‚¹ã‚¯ã§ã‚‚ã”æ¡ˆå†…ã„ãŸã—ã¾ã™ã€‚
ãŠæ°—è»½ã«ãŠå£°ãŒã‘ãã ã•ã„ã€‚
```

## ğŸ”§ APIä½¿ç”¨ä¾‹

### 1. ãƒ›ãƒ†ãƒ«ä¸€è¦§å–å¾—

```python
import requests

# ãƒ›ãƒ†ãƒ«ä¸€è¦§ã‚’å–å¾—
response = requests.get("http://localhost:8000/hotels")
hotels = response.json()

for hotel in hotels:
    print(f"ID: {hotel['id']}, åå‰: {hotel['name']}, éƒ½å¸‚: {hotel['city']}")
```

### 2. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å–å¾—

```python
# ç‰¹å®šã®ãƒ›ãƒ†ãƒ«ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—
hotel_id = 1
response = requests.get(f"http://localhost:8000/messages/{hotel_id}")
messages = response.json()

for message in messages:
    print(f"ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ : {message['platform']}")
    print(f"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: {message['message_content']}")
    print(f"å‡¦ç†æ¸ˆã¿: {message['is_processed']}")
    print("---")
```

### 3. è¿”ä¿¡å€™è£œç”Ÿæˆ

```python
# ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¯¾ã™ã‚‹è¿”ä¿¡å€™è£œã‚’å–å¾—
message_id = 1
hotel_id = 1

response = requests.post(
    f"http://localhost:8000/messages/{message_id}/suggestions",
    params={"hotel_id": hotel_id}
)

suggestions_data = response.json()
print(f"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—: {suggestions_data['message_type']}")

for i, suggestion in enumerate(suggestions_data['suggestions']):
    print(f"å€™è£œ {i+1}:")
    print(f"å†…å®¹: {suggestion['content']}")
    print(f"ä¿¡é ¼åº¦: {suggestion['confidence']}")
    print(f"ã‚¿ã‚¤ãƒ—: {suggestion['type']}")
    print("---")
```

### 4. è¿”ä¿¡é€ä¿¡

```python
# è¿”ä¿¡ã‚’é€ä¿¡
message_id = 1
response_content = "ãŠå®¢æ§˜ã€ãŠç–²ã‚Œæ§˜ã§ã™ã€‚ã”è³ªå•ã«ãŠç­”ãˆã„ãŸã—ã¾ã™ã€‚"
platform = "booking.com"

response = requests.post(
    f"http://localhost:8000/messages/{message_id}/respond",
    params={
        "response_content": response_content,
        "platform": platform
    }
)

result = response.json()
print(f"é€ä¿¡çµæœ: {result['result']}")
```

### 5. åˆ†æãƒ‡ãƒ¼ã‚¿å–å¾—

```python
# ãƒ›ãƒ†ãƒ«ã®åˆ†æãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
hotel_id = 1
response = requests.get(f"http://localhost:8000/hotels/{hotel_id}/analytics")
analytics = response.json()

print("äºˆç´„åˆ†æ:")
booking_analysis = analytics['booking_analysis']
print(f"ç·äºˆç´„æ•°: {booking_analysis['total_bookings']}")
print(f"å¹³å‡æ»åœ¨æ—¥æ•°: {booking_analysis['average_stay_duration']}æ—¥")
print(f"å¹³å‡å®¿æ³Šäººæ•°: {booking_analysis['average_guest_count']}äºº")

print("\nå­¦ç¿’çµæœ:")
learning_result = analytics['learning_result']
print(f"å‡¦ç†æ¸ˆã¿ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: {learning_result['messages_processed']}ä»¶")
print(f"å‡¦ç†æ¸ˆã¿è¿”ä¿¡: {learning_result['responses_processed']}ä»¶")
```

### 6. å‘¨è¾ºè¦³å…‰åœ°å–å¾—

```python
# ãƒ›ãƒ†ãƒ«å‘¨è¾ºã®è¦³å…‰åœ°ã‚’å–å¾—
hotel_id = 1
radius = 2000  # 2kmä»¥å†…

response = requests.get(
    f"http://localhost:8000/hotels/{hotel_id}/nearby-attractions",
    params={"radius": radius}
)

attractions_data = response.json()
attractions = attractions_data['attractions']

for attraction in attractions:
    print(f"åå‰: {attraction['name']}")
    print(f"ã‚«ãƒ†ã‚´ãƒª: {attraction['category']}")
    print(f"è·é›¢: {attraction['distance_km']}km")
    print(f"è©•ä¾¡: {attraction['rating']}/5")
    print(f"ä½æ‰€: {attraction['address']}")
    print("---")
```

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### 1. APIæ¥ç¶šã‚¨ãƒ©ãƒ¼

**å•é¡Œ:** `APIæ¥ç¶šã‚¨ãƒ©ãƒ¼: Connection refused`

**è§£æ±ºæ–¹æ³•:**
```bash
# ã‚µãƒ¼ãƒ“ã‚¹ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
docker-compose ps

# ãƒ­ã‚°ã‚’ç¢ºèª
docker-compose logs api

# ã‚µãƒ¼ãƒ“ã‚¹ã‚’å†èµ·å‹•
docker-compose restart api
```

#### 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼

**å•é¡Œ:** `Database connection failed`

**è§£æ±ºæ–¹æ³•:**
```bash
# PostgreSQLãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
docker-compose ps postgres

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å†èµ·å‹•
docker-compose restart postgres

# æ¥ç¶šæ–‡å­—åˆ—ã‚’ç¢ºèª
echo $DATABASE_URL
```

#### 3. OpenAI APIã‚¨ãƒ©ãƒ¼

**å•é¡Œ:** `OpenAI API error: Invalid API key`

**è§£æ±ºæ–¹æ³•:**
```bash
# .envãƒ•ã‚¡ã‚¤ãƒ«ã®APIã‚­ãƒ¼ã‚’ç¢ºèª
cat .env | grep OPENAI_API_KEY

# APIã‚­ãƒ¼ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
python -c "from app.config import settings; print(settings.OPENAI_API_KEY[:10] + '...')"
```

#### 4. Google Maps APIã‚¨ãƒ©ãƒ¼

**å•é¡Œ:** `Google Maps API error: REQUEST_DENIED`

**è§£æ±ºæ–¹æ³•:**
```bash
# APIã‚­ãƒ¼ã‚’ç¢ºèª
cat .env | grep GOOGLE_MAPS_API_KEY

# APIã‚­ãƒ¼ã®æ¨©é™ã‚’ç¢ºèªï¼ˆGoogle Cloud Consoleï¼‰
# Places APIã€Maps JavaScript APIã€Geocoding APIãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª
```

#### 5. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å–å¾—ã‚¨ãƒ©ãƒ¼

**å•é¡Œ:** `Failed to fetch messages`

**è§£æ±ºæ–¹æ³•:**
```bash
# å¤–éƒ¨APIã®åˆ¶é™ã‚’ç¢ºèª
# Booking.com/Airbnb APIã®åˆ¶é™ã«é”ã—ã¦ã„ãªã„ã‹ç¢ºèª

# ãƒ­ã‚°ã‚’ç¢ºèª
docker-compose logs api | grep "fetch"

# æ‰‹å‹•ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å–å¾—ã‚’ãƒ†ã‚¹ãƒˆ
curl -X POST "http://localhost:8000/messages/fetch/1"
```

### ãƒ‡ãƒãƒƒã‚°æ–¹æ³•

#### 1. ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’ä¸Šã’ã‚‹

```python
# app/config.pyã§DEBUG=Trueã«è¨­å®š
DEBUG = True

# è©³ç´°ãªãƒ­ã‚°ã‚’å‡ºåŠ›
import logging
logging.basicConfig(level=logging.DEBUG)
```

#### 2. APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆ

```bash
# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
curl http://localhost:8000/health

# ãƒ›ãƒ†ãƒ«ä¸€è¦§å–å¾—
curl http://localhost:8000/hotels

# ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å–å¾—
curl http://localhost:8000/messages/1
```

#### 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç¢ºèª

```bash
# PostgreSQLã«æ¥ç¶š
docker-compose exec postgres psql -U postgres -d hotel_agent_db

# ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ã‚’ç¢ºèª
\dt

# ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª
SELECT * FROM hotels;
SELECT * FROM guest_messages;
```

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### 1. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ´»ç”¨

```python
# Redisã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ç”¨
import redis

r = redis.Redis(host='localhost', port=6379, db=0)

# å‘¨è¾ºè¦³å…‰åœ°æƒ…å ±ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥
def get_cached_attractions(hotel_id):
    cache_key = f"attractions_{hotel_id}"
    cached_data = r.get(cache_key)
    
    if cached_data:
        return json.loads(cached_data)
    
    # ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜
    attractions = fetch_attractions(hotel_id)
    r.setex(cache_key, 3600, json.dumps(attractions))  # 1æ™‚é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
    
    return attractions
```

### 2. éåŒæœŸå‡¦ç†ã®æ´»ç”¨

```python
# ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—
from fastapi import BackgroundTasks

@app.post("/messages/fetch/{hotel_id}")
async def fetch_new_messages(
    hotel_id: int,
    background_tasks: BackgroundTasks
):
    async def save_messages():
        messages = await message_processor.fetch_all_messages(str(hotel_id))
        # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜
    
    background_tasks.add_task(save_messages)
    return {"message": "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å–å¾—ã‚’é–‹å§‹ã—ã¾ã—ãŸ"}
```

### 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–

```sql
-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆ
CREATE INDEX idx_guest_messages_hotel_id ON guest_messages(hotel_id);
CREATE INDEX idx_guest_messages_timestamp ON guest_messages(timestamp);
CREATE INDEX idx_guest_messages_processed ON guest_messages(is_processed);

-- è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX idx_guest_messages_hotel_processed ON guest_messages(hotel_id, is_processed);
```

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

### 1. APIã‚­ãƒ¼ã®ç®¡ç†

```bash
# .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’.gitignoreã«è¿½åŠ 
echo ".env" >> .gitignore

# æœ¬ç•ªç’°å¢ƒã§ã¯ç’°å¢ƒå¤‰æ•°ã‚’ä½¿ç”¨
export OPENAI_API_KEY="your-production-key"
export GOOGLE_MAPS_API_KEY="your-production-key"
```

### 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

```python
# æ¥ç¶šæ–‡å­—åˆ—ã«SSLã‚’è¿½åŠ 
DATABASE_URL = "postgresql://user:password@host:port/db?sslmode=require"
```

### 3. APIãƒ¬ãƒ¼ãƒˆåˆ¶é™

```python
# FastAPIã§ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’å®Ÿè£…
from slowapi import Limiter, _rate_limit_exceeded_handler
from slowapi.util import get_remote_address
from slowapi.errors import RateLimitExceeded

limiter = Limiter(key_func=get_remote_address)
app.state.limiter = limiter
app.add_exception_handler(RateLimitExceeded, _rate_limit_exceeded_handler)

@app.post("/messages/fetch/{hotel_id}")
@limiter.limit("10/minute")
async def fetch_new_messages(request: Request, hotel_id: int):
    # å®Ÿè£…
```

## ğŸ“ˆ ç›£è¦–ã¨ãƒ¡ãƒˆãƒªã‚¯ã‚¹

### 1. ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

```python
@app.get("/health")
async def health_check():
    return {
        "status": "healthy",
        "timestamp": datetime.now().isoformat(),
        "version": "1.0.0",
        "database": "connected",
        "redis": "connected"
    }
```

### 2. ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†

```python
# ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†çµ±è¨ˆ
@app.get("/metrics")
async def get_metrics():
    return {
        "total_messages": db.query(GuestMessage).count(),
        "processed_messages": db.query(GuestMessage).filter(GuestMessage.is_processed == True).count(),
        "pending_messages": db.query(GuestMessage).filter(GuestMessage.is_processed == False).count(),
        "average_response_time": calculate_average_response_time()
    }
```

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚è€ƒã«ã€ã‚·ã‚¹ãƒ†ãƒ ã®ä½¿ç”¨æ–¹æ³•ã‚’ç†è§£ã—ã€å®Ÿéš›ã®é‹ç”¨ã«æ´»ç”¨ã—ã¦ãã ã•ã„ã€‚ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€GitHubã®Issuesã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚
